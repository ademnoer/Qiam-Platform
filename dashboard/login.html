<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <title>منصة قيم - تسجيل الدخول</title>
        <meta content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no" name="viewport">
        <link rel="stylesheet" href="dashboard/bootstrap/css/bootstrap.min.css">
        <link rel="stylesheet" href="dashboard/bootstrap/font-awesome/css/font-awesome.min.css">
        <link rel="stylesheet" href="https://code.ionicframework.com/ionicons/2.0.1/css/ionicons.min.css">
        <link rel="stylesheet" href="dashboard/dist/css/AdminLTE.min.css">
        <link rel="stylesheet" href="dashboard/plugins/iCheck/square/green.css">
        <!--[if lt IE 9]>
            <script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
            <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
        <![endif]-->
    </head>
    <body class="hold-transition login-page">
        <div class="login-box">
            <div class="login-logo">
                <img width="120" src="img/logos/logo_qiam.png" alt="Qiam Platform">
            </div>
            <div class="login-box-body">
                <?php
                // show potential errors / feedback (from login object)
                
                if (isset($login)) {
                    if ($login->errors) {
                        foreach ($login->errors as $error) {
                            echo '<p class="login-box-msg">'.$error.'</p>';
                        }
                    }
                    if ($login->messages) {
                        foreach ($login->messages as $message) {
                            echo '<p class="login-box-msg">'.$message.'</p>';
                        }
                    }
                }

                // show potential errors / feedback (from registration object)
                if (isset($registration)) {
                    if ($registration->errors) {
                        foreach ($registration->errors as $error) {
                            echo '<p class="login-box-msg">'.$error.'</p>';
                        }
                    }
                    if ($registration->messages) {
                        foreach ($registration->messages as $message) {
                            echo '<p class="login-box-msg">'.$message.'</p>';
                        }
                    }
                }

                if (isset($_GET["register"])){ 
                    if (isset($_POST["register"])){
                        require_once('functions/classes/Registration.php');
                        $registration = new Registration();
                        if ($registration->registration_successful || $registration->verification_successful) { 
                            header("Location: dashboard.php");
                        }else{
                            echo '<p class="login-box-msg">Please make sure you fill all the field correctly</p>';
                            require_once ("dashboard/views/register.php");
                        }
                    }else{
                        require_once ("dashboard/views/register.php");                    
                    }
                }
                else{
                    require_once ("dashboard/views/login.php");
                }
                
                ?>
                
            </div>
        </div>
        <script src="dashboard/plugins/jQuery/jQuery-2.1.4.min.js"></script>
        <script src="dashboard/bootstrap/js/bootstrap.min.js"></script>
        <script src="dashboard/plugins/iCheck/icheck.min.js"></script>
        <script>
            $(function () {
                $('input').iCheck({
                    checkboxClass: 'icheckbox_square-green',
                    radioClass: 'iradio_square-green',
                    increaseArea: '20%' // optional
                });
            });
        </script>
    </body>
</html>
